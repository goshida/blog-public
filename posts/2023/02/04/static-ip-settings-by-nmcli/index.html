<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>nmcli を使って固定 IP アドレスの設定を行う - SHIDALOG</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title=SHIDALOG rel=home><div class="logo__item logo__text"><div class=logo__title>SHIDALOG</div><div class=logo__tagline>個人的に調べたこと、考えたこと、やったことなど</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/posts/><span class=menu__text>archive</span></a></li><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>about</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>nmcli を使って固定 IP アドレスの設定を行う</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2023-02-04T14:03:27+09:00>2023-02-04</time>
<time class=meta__text datetime=2023-02-16T16:07:20+09:00>(Last Modified: 2023-02-16)</time></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#nmcli-について>nmcli について</a></li><li><a href=#networkmanager-における-connection-の概念>NetworkManager における connection の概念</a></li><li><a href=#設定作業>設定作業</a><ul><li><a href=#既存設定の確認>既存設定の確認</a></li><li><a href=#新規-connection-の作成>新規 connection の作成</a></li><li><a href=#ipv4-関連の設定>IPv4 関連の設定</a></li><li><a href=#作成した-connection-の設定確認>作成した connection の設定確認</a></li><li><a href=#connection-の切替>connection の切替</a></li></ul></li><li><a href=#コマンドまとめ>コマンドまとめ</a></li><li><a href=#余談>余談</a><ul><li><a href=#自動で作成される-connection--wired-connection-1-について>自動で作成される connection （ Wired connection 1 ）について</a></li><li><a href=#自動接続設定について>自動接続設定について</a></li></ul></li><li><a href=#おわりに>おわりに</a></li></ul></nav></div></div><div class="content post__content clearfix"><p>nmcli を使ってネットワーク設定を行ったので、やったこととその中で気付いたこと等。</p><p>諸用で自宅にサーバでも立てるかと思い作業中で、その設定作業の中で固定 IP 設定をするために nmcli を初めて使った。</p><p>NetworkManager 自体は普段使っているデスクトップマシンでも使っていたのだが、
インストール時点で特に設定せずとも疎通できていたのと、ちょっと設定弄る場合も GUI で済ませていた。
なので nmcli の存在自体は知ってはいつつ実際に使ったことはなかったのだが、
久しぶりに GUI 無しの Linux で色々設定しているというのもあり、
せっかくなので触ってみようと思った次第。</p><p>実際やってみると NetworkManager での connection の概念とか、 GUI だと全然意識してなかったことに気付いたりしたので、
設定作業としてやったこととその中で気付いたこと等をまとめてみる。</p><h2 id=nmcli-について>nmcli について</h2><p>文字通り Linux でのネットワーク管理に広く使われている NetworkManger のコマンドラインインターフェース。</p><p>コマンドの基本的な使い方としてはこんな感じ。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ nmcli help
</span></span><span style=display:flex><span>Usage: nmcli <span style=color:#f92672>[</span>OPTIONS<span style=color:#f92672>]</span> OBJECT <span style=color:#f92672>{</span> COMMAND | help <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OPTIONS
</span></span><span style=display:flex><span>  -a, --ask                                ask <span style=color:#66d9ef>for</span> missing parameters
</span></span><span style=display:flex><span>  -c, --colors auto|yes|no                 whether to use colors in output
</span></span><span style=display:flex><span>  -e, --escape yes|no                      escape columns separators in values
</span></span><span style=display:flex><span>  -f, --fields &lt;field,...&gt;|all|common      specify fields to output
</span></span><span style=display:flex><span>  -g, --get-values &lt;field,...&gt;|all|common  shortcut <span style=color:#66d9ef>for</span> -m tabular -t -f
</span></span><span style=display:flex><span>  -h, --help                               print this help
</span></span><span style=display:flex><span>  -m, --mode tabular|multiline             output mode
</span></span><span style=display:flex><span>  -o, --overview                           overview mode
</span></span><span style=display:flex><span>  -p, --pretty                             pretty output
</span></span><span style=display:flex><span>  -s, --show-secrets                       allow displaying passwords
</span></span><span style=display:flex><span>  -t, --terse                              terse output
</span></span><span style=display:flex><span>  -v, --version                            show program version
</span></span><span style=display:flex><span>  -w, --wait &lt;seconds&gt;                     set timeout waiting <span style=color:#66d9ef>for</span> finishing operations
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OBJECT
</span></span><span style=display:flex><span>  g<span style=color:#f92672>[</span>eneral<span style=color:#f92672>]</span>       NetworkManager<span style=color:#e6db74>&#39;s general status and operations
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  n[etworking]    overall networking control
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  r[adio]         NetworkManager radio switches
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  c[onnection]    NetworkManager&#39;</span>s connections
</span></span><span style=display:flex><span>  d<span style=color:#f92672>[</span>evice<span style=color:#f92672>]</span>        devices managed by NetworkManager
</span></span><span style=display:flex><span>  a<span style=color:#f92672>[</span>gent<span style=color:#f92672>]</span>         NetworkManager secret agent or polkit agent
</span></span><span style=display:flex><span>  m<span style=color:#f92672>[</span>onitor<span style=color:#f92672>]</span>       monitor NetworkManager changes
</span></span></code></pre></div><p>コマンドの途中でも help 付ければ候補や説明を表示してくれる他、コマンドはある程度省略できたりする。（例えば <code>nmcli device status</code> = <code>nmcli d s</code> とか） <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ nmcli d help
</span></span><span style=display:flex><span>Usage: nmcli device <span style=color:#f92672>{</span> COMMAND | help <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>COMMAND :<span style=color:#f92672>=</span> <span style=color:#f92672>{</span> status | show | set | connect | reapply | modify | disconnect | delete | monitor | wifi | lldp <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  show <span style=color:#f92672>[</span>&lt;ifname&gt;<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  set <span style=color:#f92672>[</span>ifname<span style=color:#f92672>]</span> &lt;ifname&gt; <span style=color:#f92672>[</span>autoconnect yes|no<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>managed yes|no<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...<span style=color:#f92672>(</span>後略<span style=color:#f92672>)</span>...
</span></span></code></pre></div><p>あと全てのディストリビューションでもそうかは確認してないが、
NetworkManager のパッケージに bash 用の補完スクリプトも付属していたので、bash を使ってる場合は設定しておくと良さげ。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ pacman -Ql networkmanager | grep completion
</span></span><span style=display:flex><span>networkmanager /usr/share/bash-completion/
</span></span><span style=display:flex><span>networkmanager /usr/share/bash-completion/completions/
</span></span><span style=display:flex><span>networkmanager /usr/share/bash-completion/completions/nmcli
</span></span></code></pre></div><h2 id=networkmanager-における-connection-の概念>NetworkManager における connection の概念</h2><p>具体的な設定作業の前に NetworkManager で connection と呼ぶモノについて。</p><p>NetworkManager は有線なり Wi-Fi なりの各ネットワークデバイスに対して直接 IP アドレスやルーティング等の設定を行うのではなく、
一旦 connection と呼ばれるプロファイルの様なものを作成し、それを各インターフェースに紐付ける形を取っている。</p><figure><a href=/posts/2023/02/04/static-ip-settings-by-nmcli/images/connection.drawio.png target=_self><img src=/posts/2023/02/04/static-ip-settings-by-nmcli/images/connection.drawio_hufe6cc290183d3f500c08f663c2edfaab_37803_600x600_fit_box_3.png alt=connectionのイメージ図></a><figcaption>こんなイメージ</figcaption></figure><p>こうすることで論理的なネットワーク設定を複数持つことができて、
それらの設定を素早く切り替えたりできるのがメリットらしい。</p><p>デスクトップ・サーバマシンでそんな頻繁にネットワーク設定を切り替えることがあるとも思えない（自分がそういう経験無いだけかもだが）ので、
どちらかというと持ち運んでいろんなネットワークに繋げて使うノート PC とかを想定した設計だろうか。</p><h2 id=設定作業>設定作業</h2><h3 id=既存設定の確認>既存設定の確認</h3><p>以下の様な感じでネットワークデバイスと、現在有効な connection などを確認できる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># ネットワークデバイスの一覧とそれに紐付いている connection</span>
</span></span><span style=display:flex><span>❯ nmcli device status
</span></span><span style=display:flex><span>DEVICE           TYPE      STATE         CONNECTION         
</span></span><span style=display:flex><span>eno1             ethernet  connected     Wired connection <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>wlp58s0          wifi      disconnected  --                 
</span></span><span style=display:flex><span>p2p-dev-wlp58s0  wifi-p2p  disconnected  --                 
</span></span><span style=display:flex><span>lo               loopback  unmanaged     --                 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 作成されている connection の一覧</span>
</span></span><span style=display:flex><span>❯ nmcli connection show
</span></span><span style=display:flex><span>NAME                UUID                                  TYPE      DEVICE 
</span></span><span style=display:flex><span>Wired connection <span style=color:#ae81ff>1</span>  255ba1f6-55f2-322e-8fa0-701bcf4cecc3  ethernet  eno1
</span></span></code></pre></div><p>NetworkManager の初回起動時と思われるが、デフォルトで <code>Wired connection 1</code> という DHCP 接続する connection がすでに作成されている。
今回はこれには手を加えず、新しく connection を作成・切り替える形で設定を行う。</p><h3 id=新規-connection-の作成>新規 connection の作成</h3><p>ひとまず connection を作成。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># connection 作成</span>
</span></span><span style=display:flex><span>❯ sudo nmcli connection add con-name wired-static type ethernet
</span></span><span style=display:flex><span>Connection <span style=color:#e6db74>&#39;wired-static&#39;</span> <span style=color:#f92672>(</span>7cfee609-e3a0-4853-b69e-a2a9d3b20fee<span style=color:#f92672>)</span> successfully added.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># connection が作成されたことの確認</span>
</span></span><span style=display:flex><span>❯ nmcli connection show
</span></span><span style=display:flex><span>NAME                UUID                                  TYPE      DEVICE 
</span></span><span style=display:flex><span>Wired connection <span style=color:#ae81ff>1</span>  255ba1f6-55f2-322e-8fa0-701bcf4cecc3  ethernet  eno1   
</span></span><span style=display:flex><span>wired-static        7cfee609-e3a0-4853-b69e-a2a9d3b20fee  ethernet  --     
</span></span></code></pre></div><p>show や status といった確認コマンドなら不要だが、 add のような変更を伴う場合は root 権限が必要になる。 <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>
（権限が足りない状態で実行しようとすると <code>Insufficient privileges</code> と言われて失敗する）</p><p>パラメータの補足としてはこの辺り</p><ul><li>con-name<ul><li>コネクションの名前<ul><li>nmcli でコネクションを指定するときは一応 UUID がキーにはなるが、名前で一意に決まるなら名前でも指定できる</li><li>同じ名前でコネクションを作成することもできるが、毎回 UUID コピペするのも面倒だし間違いの元なので基本的には被らせないようにするのが無難だろうと思う</li></ul></li><li>省略した場合は type に指定した値が使われるっぽい（ ethernet とか）</li></ul></li><li>type<ul><li>接続タイプ（ ethernet, wifi, 等）を指定する。 <code>nmcli connection add help</code> とかすると色々あるのが分かる。</li></ul></li></ul><p>作成する接続タイプによってはもう少し必須パラメータがあったりするが、今回作成する ethernet ではひとまずこのくらい。</p><h3 id=ipv4-関連の設定>IPv4 関連の設定</h3><p>IP アドレス等、各種設定を connection に追加していく。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># IPv4 アドレスの設定</span>
</span></span><span style=display:flex><span>❯ sudo nmcli connection modify wired-static ipv4.addresses 192.168.2.15/24
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># IPv4 デフォルトゲートウェイの設定</span>
</span></span><span style=display:flex><span>❯ sudo nmcli connection modify wired-static ipv4.gateway 192.168.2.1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># DNS サーバの設定</span>
</span></span><span style=display:flex><span>❯ sudo nmcli connection modify wired-static ipv4.dns 8.8.8.8
</span></span><span style=display:flex><span>❯ sudo nmcli connection modify wired-static +ipv4.dns 192.168.2.1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># IPv4 の設定方法を auto ( DHCP ) から manual に変更</span>
</span></span><span style=display:flex><span>❯ sudo nmcli connection modify wired-static ipv4.method manual
</span></span></code></pre></div><p>パラメータの補足</p><ul><li>ipv4.addresses<ul><li>addresses とある通り複数設定できる</li><li>CIDR 形式じゃなくても（ <code>192.168.2.15</code> でも）設定は可能だが 、その場合 <code>/32</code> として設定される</li></ul></li><li>ipv4.dns<ul><li>値が複数ある場合、今回のようにひとつ設定して <code>+</code> で追加していく形でも設定できるが、 <code>8.8.8.8,192.168.2.1</code> のようにカンマ区切りでまとめて設定もできる</li><li>複数の値を持つパラメータから一部削除する場合は、 <code>-ipv4.dns 8.8.8.8</code> のように削るか、カンマ区切りで全部列挙して上書きする</li></ul></li><li>ipv4.method<ul><li>auto (DHCPで取得) から manual に変更している</li><li>manual を設定する場合 ipv4.address 等いくつかパラメータが設定されている必要がある</li></ul></li></ul><p>また、今回はパラメータをひとつずつ設定したかったので分けているが、以下の様に複数のパラメータを1行でまとめて設定することもできる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ sudo nmcli connection modify wired-static ipv4.addresses 192.168.2.15/24 ipv4.gateway 192.168.2.1 ipv4.dns 8.8.8.8,192.168.2.1 ipv4.method manual
</span></span></code></pre></div><p>設定としてはシンプルだが今回はこのくらい。</p><h3 id=作成した-connection-の設定確認>作成した connection の設定確認</h3><p>一応作成した connection 設定値を眺めてみる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ PAGER<span style=color:#f92672>=</span>cat nmcli connection show wired-static
</span></span><span style=display:flex><span>connection.id:                          wired-static
</span></span><span style=display:flex><span>connection.uuid:                        7cfee609-e3a0-4853-b69e-a2a9d3b20fee
</span></span><span style=display:flex><span>connection.stable-id:                   --
</span></span><span style=display:flex><span>connection.type:                        802-3-ethernet
</span></span><span style=display:flex><span>connection.interface-name:              --
</span></span><span style=display:flex><span>connection.autoconnect:                 yes
</span></span><span style=display:flex><span>connection.autoconnect-priority:        <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>connection.autoconnect-retries:         -1 <span style=color:#f92672>(</span>default<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...<span style=color:#f92672>(</span>中略<span style=color:#f92672>)</span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ipv4.method:                            manual
</span></span><span style=display:flex><span>ipv4.dns:                               8.8.8.8,192.168.2.1
</span></span><span style=display:flex><span>ipv4.dns-search:                        --
</span></span><span style=display:flex><span>ipv4.dns-options:                       --
</span></span><span style=display:flex><span>ipv4.dns-priority:                      <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>ipv4.addresses:                         192.168.2.15/24
</span></span><span style=display:flex><span>ipv4.gateway:                           192.168.2.1
</span></span><span style=display:flex><span>ipv4.routes:                            --
</span></span><span style=display:flex><span>ipv4.route-metric:                      -1
</span></span><span style=display:flex><span>ipv4.route-table:                       <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>unspec<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>ipv4.routing-rules:                     --
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...<span style=color:#f92672>(</span>後略<span style=color:#f92672>)</span>...
</span></span></code></pre></div><p>明示的に設定した部分についてはちゃんと反映されてそうではあるが、
すでに通信できている既存の DHCP 接続（ <code>Wired connection 1</code> ）の設定と比較する形でも見てみる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ PAGER<span style=color:#f92672>=</span>cat diff -U0 &lt;<span style=color:#f92672>(</span> nmcli connection show <span style=color:#e6db74>&#34;Wired connection 1&#34;</span> <span style=color:#f92672>)</span> &lt;<span style=color:#f92672>(</span> nmcli connection show wired-static <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>--- /dev/fd/63	2023-02-04 09:23:23.013572608 +0900
</span></span><span style=display:flex><span>+++ /dev/fd/62	2023-02-04 09:23:23.013572608 +0900
</span></span><span style=display:flex><span>@@ -1,2 +1,2 @@
</span></span><span style=display:flex><span>-connection.id:                          Wired connection <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-connection.uuid:                        255ba1f6-55f2-322e-8fa0-701bcf4cecc3
</span></span><span style=display:flex><span>+connection.id:                          wired-static
</span></span><span style=display:flex><span>+connection.uuid:                        7cfee609-e3a0-4853-b69e-a2a9d3b20fee
</span></span><span style=display:flex><span>@@ -5 +5 @@
</span></span><span style=display:flex><span>-connection.interface-name:              eno1
</span></span><span style=display:flex><span>+connection.interface-name:              --
</span></span><span style=display:flex><span>@@ -7 +7 @@
</span></span><span style=display:flex><span>-connection.autoconnect-priority:        -999
</span></span><span style=display:flex><span>+connection.autoconnect-priority:        <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>@@ -11 +11 @@
</span></span><span style=display:flex><span>-connection.timestamp:                   <span style=color:#ae81ff>1675469256</span>
</span></span><span style=display:flex><span>+connection.timestamp:                   <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>@@ -43,2 +43,2 @@
</span></span><span style=display:flex><span>-ipv4.method:                            auto
</span></span><span style=display:flex><span>-ipv4.dns:                               --
</span></span><span style=display:flex><span>+ipv4.method:                            manual
</span></span><span style=display:flex><span>+ipv4.dns:                               8.8.8.8,192.168.2.1
</span></span><span style=display:flex><span>@@ -48,2 +48,2 @@
</span></span><span style=display:flex><span>-ipv4.addresses:                         --
</span></span><span style=display:flex><span>-ipv4.gateway:                           --
</span></span><span style=display:flex><span>+ipv4.addresses:                         192.168.2.15/24
</span></span><span style=display:flex><span>+ipv4.gateway:                           192.168.2.1
</span></span><span style=display:flex><span>@@ -101,52 +100,0 @@
</span></span><span style=display:flex><span>-GENERAL.NAME:                           Wired connection <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-GENERAL.UUID:                           255ba1f6-55f2-322e-8fa0-701bcf4cecc3
</span></span><span style=display:flex><span>-GENERAL.DEVICES:                        eno1
</span></span><span style=display:flex><span>-GENERAL.IP-IFACE:                       eno1
</span></span><span style=display:flex><span>-GENERAL.STATE:                          activated
</span></span><span style=display:flex><span>-GENERAL.DEFAULT:                        yes
</span></span><span style=display:flex><span>-GENERAL.DEFAULT6:                       no
</span></span><span style=display:flex><span>-GENERAL.SPEC-OBJECT:                    --
</span></span><span style=display:flex><span>-GENERAL.VPN:                            no
</span></span><span style=display:flex><span>-GENERAL.DBUS-PATH:                      /org/freedesktop/NetworkManager/ActiveConnection/1
</span></span><span style=display:flex><span>-GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/Settings/1
</span></span><span style=display:flex><span>-GENERAL.ZONE:                           --
</span></span><span style=display:flex><span>-GENERAL.MASTER-PATH:                    --
</span></span><span style=display:flex><span>-IP4.ADDRESS<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:                         192.168.2.206/24
</span></span><span style=display:flex><span>-IP4.GATEWAY:                            192.168.2.1
</span></span><span style=display:flex><span>-IP4.ROUTE<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:                           dst <span style=color:#f92672>=</span> 192.168.2.0/24, nh <span style=color:#f92672>=</span> 0.0.0.0, mt <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>-IP4.ROUTE<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>:                           dst <span style=color:#f92672>=</span> 0.0.0.0/0, nh <span style=color:#f92672>=</span> 192.168.2.1, mt <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>-IP4.DNS<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:                             8.8.8.8
</span></span><span style=display:flex><span>-IP4.DNS<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>:                             192.168.2.1
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:                        broadcast_address <span style=color:#f92672>=</span> 192.168.2.255
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span>:                        dhcp_client_identifier <span style=color:#f92672>=</span> 01:1c:69:7a:0c:f9:89
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>:                        dhcp_lease_time <span style=color:#f92672>=</span> <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>4<span style=color:#f92672>]</span>:                        dhcp_server_identifier <span style=color:#f92672>=</span> 192.168.2.1
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>5<span style=color:#f92672>]</span>:                        domain_name_servers <span style=color:#f92672>=</span> 8.8.8.8 192.168.2.1
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>6<span style=color:#f92672>]</span>:                        expiry <span style=color:#f92672>=</span> <span style=color:#ae81ff>1675555656</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>7<span style=color:#f92672>]</span>:                        host_name <span style=color:#f92672>=</span> nuc
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>8<span style=color:#f92672>]</span>:                        ip_address <span style=color:#f92672>=</span> 192.168.2.206
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>9<span style=color:#f92672>]</span>:                        next_server <span style=color:#f92672>=</span> 192.168.2.1
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>10<span style=color:#f92672>]</span>:                       requested_broadcast_address <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>11<span style=color:#f92672>]</span>:                       requested_domain_name <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>12<span style=color:#f92672>]</span>:                       requested_domain_name_servers <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>13<span style=color:#f92672>]</span>:                       requested_domain_search <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>14<span style=color:#f92672>]</span>:                       requested_host_name <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>15<span style=color:#f92672>]</span>:                       requested_interface_mtu <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>16<span style=color:#f92672>]</span>:                       requested_ms_classless_static_routes <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>17<span style=color:#f92672>]</span>:                       requested_nis_domain <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>18<span style=color:#f92672>]</span>:                       requested_nis_servers <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>19<span style=color:#f92672>]</span>:                       requested_ntp_servers <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>20<span style=color:#f92672>]</span>:                       requested_rfc3442_classless_static_routes <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>21<span style=color:#f92672>]</span>:                       requested_root_path <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>22<span style=color:#f92672>]</span>:                       requested_routers <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>23<span style=color:#f92672>]</span>:                       requested_static_routes <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>24<span style=color:#f92672>]</span>:                       requested_subnet_mask <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>25<span style=color:#f92672>]</span>:                       requested_time_offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>26<span style=color:#f92672>]</span>:                       requested_wpad <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>27<span style=color:#f92672>]</span>:                       routers <span style=color:#f92672>=</span> 192.168.2.1
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>28<span style=color:#f92672>]</span>:                       subnet_mask <span style=color:#f92672>=</span> 255.255.255.0
</span></span><span style=display:flex><span>-DHCP4.OPTION<span style=color:#f92672>[</span>29<span style=color:#f92672>]</span>:                       wpad <span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span>-
</span></span><span style=display:flex><span>-IP6.ADDRESS<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:                         fe80::4b2:8103:9857:8c55/64
</span></span><span style=display:flex><span>-IP6.GATEWAY:                            --
</span></span><span style=display:flex><span>-IP6.ROUTE<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:                           dst <span style=color:#f92672>=</span> fe80::/64, nh <span style=color:#f92672>=</span> ::, mt <span style=color:#f92672>=</span> <span style=color:#ae81ff>1024</span>
</span></span></code></pre></div><p>差分としては、</p><ul><li><code>connection.*</code> 辺りの値は NetworkManger での管理上の値っぽいので問題無し</li><li><code>ipv4.*</code> 辺りは今回明示的に設定した部分なので問題無し</li><li><code>GENERAL.*</code> 辺りは <code>connection.*</code> と似たようなモノっぽいので問題無し</li><li><code>IPV4.*</code> <code>DHCP.*</code> <code>IP6.*</code> 辺りは DHCP で取得したものっぽいので多分問題無し</li></ul><p>ということで大丈夫そう。</p><p>眺めた感じ小文字部分が connection の設定値で、
大文字部分が DHCP 等動的に取得したもの等も含めた最終的な値って感じだろうか。</p><h3 id=connection-の切替>connection の切替</h3><p>最後にネットワーク設定を切り替える。</p><p>切替前の状態を見ておく。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># ネットワークデバイスと設定されている connection</span>
</span></span><span style=display:flex><span>❯ nmcli device status
</span></span><span style=display:flex><span>DEVICE           TYPE      STATE         CONNECTION         
</span></span><span style=display:flex><span>eno1             ethernet  connected     Wired connection <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span>wlp58s0          wifi      disconnected  --                 
</span></span><span style=display:flex><span>p2p-dev-wlp58s0  wifi-p2p  disconnected  --                 
</span></span><span style=display:flex><span>lo               loopback  unmanaged     --                 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 今のIPアドレス等</span>
</span></span><span style=display:flex><span>❯ ip address show eno1
</span></span><span style=display:flex><span>2: eno1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style=color:#ae81ff>1500</span> qdisc fq_codel state UP group default qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>    link/ether 1c:69:7a:0c:f9:89 brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>    altname enp0s31f6
</span></span><span style=display:flex><span>    inet 192.168.2.206/24 brd 192.168.2.255 scope global dynamic noprefixroute eno1
</span></span><span style=display:flex><span>       valid_lft 85068sec preferred_lft 85068sec
</span></span><span style=display:flex><span>    inet6 fe80::4b2:8103:9857:8c55/64 scope link noprefixroute 
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><p>実際に切り替える</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># 今回作成した connection を有線ネットワークデバイス（ eno1 ）に紐付ける</span>
</span></span><span style=display:flex><span>❯ sudo nmcli connection modify wired-static ifname eno1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># wired-connection を有効化する（同じネットワークデバイスに紐付いた別の connection が active になっている場合はこのタイミングで自動で inactive になる）</span>
</span></span><span style=display:flex><span>❯ sudo nmcli connection up wired-static
</span></span><span style=display:flex><span>Connection successfully activated <span style=color:#f92672>(</span>D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/2<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>ちゃんと切り替わったか確認</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># 有線ネットワークデバイス( eno1 ) に今回作成した connection ( wired-static ) が適用されている</span>
</span></span><span style=display:flex><span>❯ nmcli device status
</span></span><span style=display:flex><span>DEVICE           TYPE      STATE         CONNECTION   
</span></span><span style=display:flex><span>eno1             ethernet  connected     wired-static 
</span></span><span style=display:flex><span>wlp58s0          wifi      disconnected  --           
</span></span><span style=display:flex><span>p2p-dev-wlp58s0  wifi-p2p  disconnected  --           
</span></span><span style=display:flex><span>lo               loopback  unmanaged     --           
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># connection 一覧からも確認</span>
</span></span><span style=display:flex><span>❯ nmcli connection show
</span></span><span style=display:flex><span>NAME                UUID                                  TYPE      DEVICE 
</span></span><span style=display:flex><span>wired-static        7cfee609-e3a0-4853-b69e-a2a9d3b20fee  ethernet  eno1   
</span></span><span style=display:flex><span>Wired connection <span style=color:#ae81ff>1</span>  255ba1f6-55f2-322e-8fa0-701bcf4cecc3  ethernet  --     
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># IP アドレスも想定通りになっている</span>
</span></span><span style=display:flex><span>❯ ip address show eno1
</span></span><span style=display:flex><span>2: eno1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style=color:#ae81ff>1500</span> qdisc fq_codel state UP group default qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>    link/ether 1c:69:7a:0c:f9:89 brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>    altname enp0s31f6
</span></span><span style=display:flex><span>    inet 192.168.2.15/24 brd 192.168.2.255 scope global noprefixroute eno1
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft forever
</span></span><span style=display:flex><span>    inet6 fe80::339e:3e8f:5bc9:ff5/64 scope link noprefixroute 
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft forever
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># インターネット上の適当なところへ疎通確認</span>
</span></span><span style=display:flex><span>❯ ping google.com
</span></span><span style=display:flex><span>PING google.com <span style=color:#f92672>(</span>172.217.26.238<span style=color:#f92672>)</span> 56<span style=color:#f92672>(</span>84<span style=color:#f92672>)</span> bytes of data.
</span></span><span style=display:flex><span><span style=color:#ae81ff>64</span> bytes from nrt12s51-in-f14.1e100.net <span style=color:#f92672>(</span>172.217.26.238<span style=color:#f92672>)</span>: icmp_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>116</span> time<span style=color:#f92672>=</span>2.89 ms
</span></span><span style=display:flex><span><span style=color:#ae81ff>64</span> bytes from nrt12s51-in-f14.1e100.net <span style=color:#f92672>(</span>172.217.26.238<span style=color:#f92672>)</span>: icmp_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>116</span> time<span style=color:#f92672>=</span>3.14 ms
</span></span><span style=display:flex><span><span style=color:#ae81ff>64</span> bytes from nrt12s51-in-f14.1e100.net <span style=color:#f92672>(</span>172.217.26.238<span style=color:#f92672>)</span>: icmp_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>116</span> time<span style=color:#f92672>=</span>3.29 ms
</span></span><span style=display:flex><span>^C
</span></span><span style=display:flex><span>--- google.com ping statistics ---
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> packets transmitted, <span style=color:#ae81ff>3</span> received, 0% packet loss, time 2003ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev <span style=color:#f92672>=</span> 2.889/3.105/3.288/0.164 ms
</span></span></code></pre></div><p>ということで設定完了。</p><h2 id=コマンドまとめ>コマンドまとめ</h2><p>補足や出力結果で間延びした感があるので、改めて設定コマンドのみを抜粋</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>nmcli device status
</span></span><span style=display:flex><span>nmcli connection show
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo nmcli connection add con-name wired-static type ethernet
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo nmcli connection modify wired-static ipv4.addresses 192.168.2.15/24
</span></span><span style=display:flex><span>sudo nmcli connection modify wired-static ipv4.gateway 192.168.2.1
</span></span><span style=display:flex><span>sudo nmcli connection modify wired-static ipv4.dns 8.8.8.8
</span></span><span style=display:flex><span>sudo nmcli connection modify wired-static +ipv4.dns 192.168.2.1
</span></span><span style=display:flex><span>sudo nmcli connection modify wired-static ipv4.method manual
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo nmcli connection modify wired-static ifname eno1
</span></span><span style=display:flex><span>sudo nmcli connection up wired-static
</span></span></code></pre></div><h2 id=余談>余談</h2><h3 id=自動で作成される-connection--wired-connection-1-について>自動で作成される connection （ Wired connection 1 ）について</h3><p>作業時点で既に作成されていた <code>Wired connection 1</code> （日本語ロケールだと <code>有線接続1</code> ）という connection だが、
今回の <code>wired-static</code> を作成した後でシステムを再起動すると消えていた。
（ NetworkManager.service の再起動では残っていた）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ nmcli connection show
</span></span><span style=display:flex><span>NAME                UUID                                  TYPE      DEVICE 
</span></span><span style=display:flex><span>wired-static        7cfee609-e3a0-4853-b69e-a2a9d3b20fee  ethernet  eno1   
</span></span></code></pre></div><p>で、試しに作った connection を削除して NetworkManager を再起動してみるとまた現れた。</p><p>こんな感じ。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># connection を削除</span>
</span></span><span style=display:flex><span>❯ sudo nmcli connection delete wired-static
</span></span><span style=display:flex><span>Connection <span style=color:#e6db74>&#39;wired-static&#39;</span> <span style=color:#f92672>(</span>7cfee609-e3a0-4853-b69e-a2a9d3b20fee<span style=color:#f92672>)</span> successfully deleted.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># connection が一つも無いのを確認</span>
</span></span><span style=display:flex><span>❯ nmcli connection show
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># device の方でも確認</span>
</span></span><span style=display:flex><span>❯ nmcli device status
</span></span><span style=display:flex><span>DEVICE           TYPE      STATE         CONNECTION 
</span></span><span style=display:flex><span>eno1             ethernet  disconnected  --         
</span></span><span style=display:flex><span>wlp58s0          wifi      disconnected  --         
</span></span><span style=display:flex><span>p2p-dev-wlp58s0  wifi-p2p  disconnected  --         
</span></span><span style=display:flex><span>lo               loopback  unmanaged     --         
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># NetworkManager.service を再起動</span>
</span></span><span style=display:flex><span>❯ sudo systemctl restart NetworkManager.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 改めて connection を確認すると勝手にできている</span>
</span></span><span style=display:flex><span>❯ nmcli connection show
</span></span><span style=display:flex><span>NAME                UUID                                  TYPE      DEVICE 
</span></span><span style=display:flex><span>Wired connection <span style=color:#ae81ff>1</span>  255ba1f6-55f2-322e-8fa0-701bcf4cecc3  ethernet  eno1   
</span></span></code></pre></div><p>また、 <code>nmcli connection add 〜</code> で connection を作成した場合は以下の様に設定ファイルが作られるが、
自動で設定された <code>Wired connection 1</code> のファイルは作られない。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ nmcli connection show
</span></span><span style=display:flex><span>NAME                UUID                                  TYPE      DEVICE 
</span></span><span style=display:flex><span>wired-static        f7d3fe23-2c70-4025-aa59-38f65a365f8b  ethernet  eno1   
</span></span><span style=display:flex><span>Wired connection <span style=color:#ae81ff>1</span>  255ba1f6-55f2-322e-8fa0-701bcf4cecc3  ethernet  --     
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>❯ sudo ls -lh /etc/NetworkManager/system-connections/
</span></span><span style=display:flex><span>total 4.0K
</span></span><span style=display:flex><span>-rw------- <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>252</span> Feb  <span style=color:#ae81ff>4</span> 11:38 wired-static.nmconnection
</span></span></code></pre></div><p>この辺りを考えると自動で設定を作成しているというよりは、一時的な設定を行っているという理解が正しそう。</p><p>GUI で設定してた時は特に意識せずこの <code>Wired connection 1</code> を直接弄ったりしていたが、
設定を弄るなら別で connection を作って設定した方が良いのかもしれない。
（これまで GUI で弄っていて突然設定が飛んだみたいな記憶は無いので、 connection ひとつで使っている分には実際に困ることは無いのかもだが気分的に）</p><p>この辺りはもう少しドキュメント追うなり試すなりしても良いかもしれない。</p><h3 id=自動接続設定について>自動接続設定について</h3><p>今回の作業の中では特に必要なかったので省略したが、
自動接続するかどうかや、自動接続する connection が複数ある場合にどの connection を優先して使うかはこの辺りのパラメータで制御できるっぽい。
（明示的に設定しなかった場合は以下の値になる）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>❯ nmcli connection show wired-static | grep autoconnect
</span></span><span style=display:flex><span>connection.autoconnect:                 yes
</span></span><span style=display:flex><span>connection.autoconnect-priority:        <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>connection.autoconnect-retries:         -1 <span style=color:#f92672>(</span>default<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>connection.autoconnect-slaves:          -1 <span style=color:#f92672>(</span>default<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>ノートPC の Wi-Fi の設定は NetworkManager の GUI で設定したが、
どの SSID に優先して繋ぐとかも細かく設定できそうなので眺めてみても良さそう。
（特に意識せず設定した場合にどうなるかというのを見る意味も含めて）</p><h2 id=おわりに>おわりに</h2><p>やったこと自体は「固定 IP アドレスを設定した」だけなので大したことはやってないのだが意外と学びはあった。
（具体的に今後何かの役に立つかは微妙だが）</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>IOS とかのコマンドが似たような操作だが Linux のコマンドだとあんまりこのスタイル見ない気がする。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>今回記事の中で設定したマシンとは別のマシン（普段デスクトップとして使っているヤツ）では sudo 無しで connection の作成などができていた。そちらではデスクトップ環境として Xfce をインストールしているのでその辺りの関係な気はするが。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/linux/ rel=tag>Linux</a></li></ul></div></footer></article></main></div><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search method=get action=https://google.com/search><label><input class=widget-search__field type=search placeholder=SEARCH… name=q aria-label=SEARCH…></label>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://blog.shida-ws.net/></form></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/posts/2023/02/12/configure-wireguard-based-on-nmcli/>nmcli を用いた WireGuard の設定</a></li><li class=widget__item><a class=widget__link href=/posts/2023/02/04/static-ip-settings-by-nmcli/>nmcli を使って固定 IP アドレスの設定を行う</a></li><li class=widget__item><a class=widget__link href=/posts/2023/01/15/steam-play-on-archlinux/>Arch Linux で Steam Play ( Proton ) を試す</a></li><li class=widget__item><a class=widget__link href=/posts/2022/12/23/use-reflector-to-select-archlinux-mirrorlist/>Arch Linux のミラーリストの設定に reflector を使う</a></li><li class=widget__item><a class=widget__link href=/posts/2022/11/18/capslock-as-ctrl-in-xkb-configuration/>XKB の設定で capslock を ctrl として使えるようにする</a></li><li class=widget__item><a class=widget__link href=/posts/2022/11/08/hugo-image-processing-for-thumbnail/>Hugo の Image Processing を使ってサムネイルを生成する</a></li><li class=widget__item><a class=widget__link href=/posts/2022/10/28/implement-baguettebox-js-in-hugo/>Hugo に baguetteBox.js を埋め込む</a></li><li class=widget__item><a class=widget__link href=/posts/2022/10/23/google-search-console/>Google Search Console を使ってサイトを Google インデックスに登録してもらう</a></li><li class=widget__item><a class=widget__link href=/posts/2022/09/24/image-conversion-for-blog/>写真をブログに乗せるための変換コマンド</a></li><li class=widget__item><a class=widget__link href=/posts/2022/09/19/started-sutra-copying/>写経を始めた</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/tags/arch-linux/ title="Arch Linux">Arch Linux</a>
<a class="widget-taglist__link widget__link btn" href=/tags/github/ title=GitHub>GitHub</a>
<a class="widget-taglist__link widget__link btn" href=/tags/google-search-console/ title="Google Search Console">Google Search Console</a>
<a class="widget-taglist__link widget__link btn" href=/tags/hugo/ title=Hugo>Hugo</a>
<a class="widget-taglist__link widget__link btn" href=/tags/linux/ title=Linux>Linux</a>
<a class="widget-taglist__link widget__link btn" href=/tags/steam/ title=Steam>Steam</a>
<a class="widget-taglist__link widget__link btn" href=/tags/vpn/ title=VPN>VPN</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E3%82%B2%E3%83%BC%E3%83%A0/ title=ゲーム>ゲーム</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E3%83%96%E3%83%AD%E3%82%B0/ title=ブログ>ブログ</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%86%99%E7%B5%8C/ title=写経>写経</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%9B%91%E8%A8%98/ title=雑記>雑記</a></div></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=GitHub rel="noopener noreferrer" href=https://github.com/goshida target=_blank><svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0C85.9.0.0 85.8.0 191.7c0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2.0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8.0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7.0.0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4.0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5.0 25.6-.2 46.3-.2 52.6.0 5.1 3.5 11.1 13.2 9.2C329 348.2 384 276.4 384 191.7 384 85.8 298 0 192 0z"/></svg><span>GitHub</span></a></div></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2023 shida.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>