<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Neovim でマウス操作を無効にする - SHIDALOG</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title=SHIDALOG rel=home><div class="logo__item logo__text"><div class=logo__title>SHIDALOG</div><div class=logo__tagline>個人的に調べたこと、考えたこと、やったことなど</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/posts/><span class=menu__text>archive</span></a></li><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>about</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Neovim でマウス操作を無効にする</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2023-02-20T11:19:41+09:00>2023-02-20</time></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#設定作業>設定作業</a></li><li><a href=#関連して調べたこと>関連して調べたこと</a><ul><li><a href=#mouse-について>mouse について</a></li><li><a href=#mouse-a-について>mouse-=a について</a></li></ul></li></ul></nav></div></div><div class="content post__content clearfix"><p>タイトル通り。</p><p>Neovim を使っているので一応このタイトルにしているが、特に Vim との違いとかって意図は無い。</p><p>自分は Linux でエディタとして Neovim 、デスクトップ環境として Xfce を使っているのだが、
フォーカスを切り替えるときにウィンドウ内の適当な場所をクリックして切り替えることが多い。</p><p>で、ブラウザで何かを調べながら、ターミナル（ Neovim ）で文章書いてたり設定ファイル弄るみたいなこともよくやっているが、
ターミナルをクリックしたときにカーソル位置がずれるのが結構ストレスになっていたので無効化した。</p><p>設定自体は１行なのだが、その1行を理解するために調べたこと。</p><h2 id=設定作業>設定作業</h2><p>ググれば記事は色々ヒットするが、実際やることとしてはそれらと同じで以下を設定ファイル（ <code>.config/nvim/init.vim</code> なり <code>.vimrc</code> なり）に足すだけ。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>set mouse<span style=color:#f92672>=</span>
</span></span></code></pre></div><h2 id=関連して調べたこと>関連して調べたこと</h2><h3 id=mouse-について>mouse について</h3><p>そもそもの mouse オプションについて。</p><p>mouse が何をしているオプションかというところから知らなかったので、ひとまず <code>:help mouse</code> を確認。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#e6db74>&#39;mouse&#39;</span>                 string  <span style=color:#f92672>(</span>default <span style=color:#e6db74>&#34;nvi&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                        global
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Enables mouse support. For example, to enable the mouse in Normal mode
</span></span><span style=display:flex><span>        and Visual mode:
</span></span><span style=display:flex><span>                :set mouse<span style=color:#f92672>=</span>nv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        To temporarily disable mouse support, hold the shift key <span style=color:#66d9ef>while</span> using
</span></span><span style=display:flex><span>        the mouse.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Mouse support can be enabled <span style=color:#66d9ef>for</span> different modes:
</span></span><span style=display:flex><span>                n       Normal mode
</span></span><span style=display:flex><span>                v       Visual mode
</span></span><span style=display:flex><span>                i       Insert mode
</span></span><span style=display:flex><span>                c       Command-line mode                
</span></span><span style=display:flex><span>                h       all previous modes when editing a help file
</span></span><span style=display:flex><span>                a       all previous modes
</span></span><span style=display:flex><span>                r       <span style=color:#66d9ef>for</span> hit-enter and more-prompt prompt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Left-click anywhere in a text buffer to place the cursor there.  This
</span></span><span style=display:flex><span>        works with operators too, e.g. type d <span style=color:#66d9ef>then</span> left-click to delete text
</span></span><span style=display:flex><span>        from the current cursor position to the position where you clicked.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Drag the status-line or vertical separator of a window to resize it.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        If enabled <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#34;v&#34;</span> <span style=color:#f92672>(</span>Visual mode<span style=color:#f92672>)</span> <span style=color:#66d9ef>then</span> double-click selects word-wise,
</span></span><span style=display:flex><span>        triple-click makes it line-wise, and quadruple-click makes it
</span></span><span style=display:flex><span>        rectangular block-wise.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        For scrolling with a mouse wheel see scroll-mouse-wheel.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Note: When enabling the mouse in a terminal, copy/paste will use the
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;* register if possible. See also &#39;clipboard&#39;.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Related options:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#39;mousefocus&#39;    window focus follows mouse pointer
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#39;mousemodel&#39;    what mouse button does which action
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#39;mousehide&#39;     hide mouse pointer while typing text
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#39;selectmode&#39;    whether to start Select mode or Visual mode
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        The :behave command provides some &#34;</span>profiles<span style=color:#e6db74>&#34; for mouse behavior.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                                                :behave :be
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        :be[have] {model}       Set behavior for mouse and selection.  Valid
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                arguments are:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                   mswin        MS-Windows behavior
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                   xterm        Xterm behavior
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                Using &#34;</span>:behave<span style=color:#e6db74>&#34; changes these options:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                option          mswin                   xterm
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                &#39;selectmode&#39;    &#34;</span>mouse,key<span style=color:#e6db74>&#34;             &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                &#39;mousemodel&#39;    &#34;</span>popup<span style=color:#e6db74>&#34;                 &#34;</span>extend<span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                &#39;keymodel&#39;      &#34;</span>startsel,stopsel<span style=color:#e6db74>&#34;      &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                &#39;selection&#39;     &#34;</span>exclusive<span style=color:#e6db74>&#34;             &#34;</span>inclusive<span style=color:#e6db74>&#34;
</span></span></span></code></pre></div><p>ということで、マウス操作を有効化するモードを指定するオプションだった。</p><p>（自分の環境だと）デフォルトが <code>mouse=nvi</code> になっているところを、<code>mouse=</code> （有効化するモード無し）とすることで、マウス操作を全モードで無効化する形。</p><p>ちなみに <code>mouse=</code> として全モードでマウス操作を無効化していても、ホイールスクロールは有効なままだった。
マウスを使った操作全般というよりは、ウィンドウ内のカーソル座標を使うイベントが mouse オプションでの有効無効の対象になっている感じだろうか。
ホイールスクロールについては特に困ってなかったので、それ以上は追わずそのままにしている。</p><p>余談だが、このヘルプ読んで Shirt キーとのコンビネーションで一時的に無効化できるということを初めて知った。</p><h3 id=mouse-a-について>mouse-=a について</h3><p>マウスの無効化の方法について調べていると、 <code>set mouse-=a</code> としている記事もいくつかあった。</p><p>mouse オプションでの指定から全てのモードを削除する、
と雰囲気で解釈した（ <code>chmod a-x</code> とかでの <code>-</code> と似たような感じ）のだが、自分の環境ではこれだと無効化されなかった。</p><p><code>-=</code> の理解が間違っているのかと思い一応 <code>:help set</code> を見ると以下の感じ。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>:se<span style=color:#f92672>[</span>t<span style=color:#f92672>]</span> <span style=color:#f92672>{</span>option<span style=color:#f92672>}</span>-<span style=color:#f92672>={</span>value<span style=color:#f92672>}</span>                                :set-<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>                        Subtract the <span style=color:#f92672>{</span>value<span style=color:#f92672>}</span> from a number option, or remove
</span></span><span style=display:flex><span>                        the <span style=color:#f92672>{</span>value<span style=color:#f92672>}</span> from a string option, <span style=color:#66d9ef>if</span> it is there.     
</span></span><span style=display:flex><span>                        If the <span style=color:#f92672>{</span>value<span style=color:#f92672>}</span> is not found in a string option, there
</span></span><span style=display:flex><span>                        is no error or warning.  When the option is a comma-
</span></span><span style=display:flex><span>                        separated list, a comma is deleted, unless the option
</span></span><span style=display:flex><span>                        becomes empty.                               
</span></span><span style=display:flex><span>                        When the option is a list of flags, <span style=color:#f92672>{</span>value<span style=color:#f92672>}</span> must be
</span></span><span style=display:flex><span>                        exactly as they appear in the option.  Remove flags
</span></span><span style=display:flex><span>                        one by one to avoid problems.               
</span></span><span style=display:flex><span>                        Also see :set-args above.
</span></span></code></pre></div><p>オプションの種類によって動きが違うが、以下のような処理をする演算子。</p><ul><li>オプションが数値<ul><li>与えられた数値分減算する</li></ul></li><li>オプションが文字列<ul><li>与えられた文字列が含まれている場合はそれを削除する</li><li>文字列がフラグのリストになっている場合は値の中に現れている通り正確に指定すること</li></ul></li></ul><p>デフォルトで <code>mouse=nvi</code> となっているところから、 <code>mouse-=a</code> で削除しようとしても <code>a</code> が値に含まれていないので <code>mouse=nvi</code> から変わらない。
（ <code>a</code> を全モードとして解釈してフラグを落としたりはしない）
ということで効かなかったらしい。</p><p>Neovim(Vim) のバージョンなのか使っているパッケージ（ディストリビューション）の設定なのかは分からないが、
場合によってはデフォルト値が <code>mouse=a</code> になっていて、その場合の記事だったのかもしれない。</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/neovim/ rel=tag>Neovim</a></li></ul></div></footer></article></main></div><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search method=get action=https://google.com/search><label><input class=widget-search__field type=search placeholder=SEARCH… name=q aria-label=SEARCH…></label>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://blog.shida-ws.net/></form></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/posts/2023/02/20/disable-mouse-in-nvim/>Neovim でマウス操作を無効にする</a></li><li class=widget__item><a class=widget__link href=/posts/2023/02/12/configure-wireguard-based-on-nmcli/>nmcli を用いた WireGuard の設定</a></li><li class=widget__item><a class=widget__link href=/posts/2023/02/04/static-ip-settings-by-nmcli/>nmcli を使って固定 IP アドレスの設定を行う</a></li><li class=widget__item><a class=widget__link href=/posts/2023/01/15/steam-play-on-archlinux/>Arch Linux で Steam Play ( Proton ) を試す</a></li><li class=widget__item><a class=widget__link href=/posts/2022/12/23/use-reflector-to-select-archlinux-mirrorlist/>Arch Linux のミラーリストの設定に reflector を使う</a></li><li class=widget__item><a class=widget__link href=/posts/2022/11/18/capslock-as-ctrl-in-xkb-configuration/>XKB の設定で capslock を ctrl として使えるようにする</a></li><li class=widget__item><a class=widget__link href=/posts/2022/11/08/hugo-image-processing-for-thumbnail/>Hugo の Image Processing を使ってサムネイルを生成する</a></li><li class=widget__item><a class=widget__link href=/posts/2022/10/28/implement-baguettebox-js-in-hugo/>Hugo に baguetteBox.js を埋め込む</a></li><li class=widget__item><a class=widget__link href=/posts/2022/10/23/google-search-console/>Google Search Console を使ってサイトを Google インデックスに登録してもらう</a></li><li class=widget__item><a class=widget__link href=/posts/2022/09/24/image-conversion-for-blog/>写真をブログに乗せるための変換コマンド</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/tags/arch-linux/ title="Arch Linux">Arch Linux</a>
<a class="widget-taglist__link widget__link btn" href=/tags/github/ title=GitHub>GitHub</a>
<a class="widget-taglist__link widget__link btn" href=/tags/google-search-console/ title="Google Search Console">Google Search Console</a>
<a class="widget-taglist__link widget__link btn" href=/tags/hugo/ title=Hugo>Hugo</a>
<a class="widget-taglist__link widget__link btn" href=/tags/linux/ title=Linux>Linux</a>
<a class="widget-taglist__link widget__link btn" href=/tags/neovim/ title=Neovim>Neovim</a>
<a class="widget-taglist__link widget__link btn" href=/tags/steam/ title=Steam>Steam</a>
<a class="widget-taglist__link widget__link btn" href=/tags/vpn/ title=VPN>VPN</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E3%82%B2%E3%83%BC%E3%83%A0/ title=ゲーム>ゲーム</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E3%83%96%E3%83%AD%E3%82%B0/ title=ブログ>ブログ</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%86%99%E7%B5%8C/ title=写経>写経</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%9B%91%E8%A8%98/ title=雑記>雑記</a></div></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=GitHub rel="noopener noreferrer" href=https://github.com/goshida target=_blank><svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0C85.9.0.0 85.8.0 191.7c0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2.0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8.0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7.0.0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4.0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5.0 25.6-.2 46.3-.2 52.6.0 5.1 3.5 11.1 13.2 9.2C329 348.2 384 276.4 384 191.7 384 85.8 298 0 192 0z"/></svg><span>GitHub</span></a></div></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2023 shida.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>